<!-- ...existing code... -->
<div class="app-root-bg min-vh-100 p-3">
  <!-- Header -->
  <div class="d-flex align-items-center mb-3 header-bar px-2">
    <h4 class="m-0 me-auto header-title">App-comercial</h4>
    <div class="flex-grow-1 text-center breadcrumb-title">Aplicaciones/Seguimiento/Buscar</div>
  </div>

  <div class="row gx-3">
    <!-- Left sidebar -->
    <aside class="col-md-3">
      <div class="sidebar p-3">
        <h6>Buscar Cliente</h6>

        <div class="mb-3">
          <input
            type="text"
            class="form-control"
            placeholder="Buscar por nombre, contacto, tel√©fono..."
            [(ngModel)]="searchText"
            (ngModelChange)="onSearchChange($event)"
          />
        </div>

        <label class="form-label small">Campa√±a</label>
        <select class="form-select mb-2">
          <option>POTENCIALES</option>
        </select>

        <label class="form-label small">Usuario</label>
        <select class="form-select mb-3">
          <option>MVELASQUEZ</option>
        </select>

        <hr>

        <ul class="list-unstyled action-list">
          <li class="mb-3 d-flex align-items-start">
            <img src="assets/icons/calendar.svg" width="32" class="me-2" alt="">
            <div>
              <div class="small fw-bold">Asignacion de Clientes a Usuarios</div>
            </div>
          </li>
          <li class="d-flex align-items-start">
            <img src="assets/icons/reagendar.svg" width="32" class="me-2" alt="">
            <div class="small fw-bold">Re-agendar clientes a usuarios</div>
          </li>
        </ul>
      </div>
    </aside>

    <!-- Main content -->
    <main class="col-md-9">
      <!-- top nav (BUSQUEDA, AGENDA DEL DIA, ...) -->
      <ul class="nav nav-tabs mb-2 small">
        <li class="nav-item" *ngFor="let vt of viewTabs; let i = index">
          <a class="nav-link" [class.active]="activeView === i" (click)="activeView = i; $event.preventDefault()" href="javascript:void(0)">{{ vt }}</a>
        </li>
      </ul>

      <!-- B√öSQUEDA view (default) -->
      <div *ngIf="activeView === 0">
        <!-- companies grid -->
        <div class="card mb-3">
          <div class="card-body p-2">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span class="fw-bold small">EMPRESAS</span>
              <button class="btn btn-primary btn-sm" (click)="agregarNuevaEmpresa()">
                <span>+ Nuevo Cliente</span>
              </button>
            </div>
            <div class="table-scroll-container">
              <table class="table table-sm mb-0">
                <thead class="table-light small">
                  <tr>
                    <th>Razon Social</th>
                    <th>Contacto</th>
                    <th>N√∫mero de contacto</th>
                    <th>Fecha de contacto</th>
                    <th>USUARIO</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let c of filteredCompanies" (click)="selectCompany(c)" [class.table-primary]="selected.id === c.id" style="cursor:pointer">
                    <td><strong>{{ c.name }}</strong></td>
                    <td>{{ c.contact }}</td>
                    <td>{{ c.phone }}</td>
                    <td>{{ getUltimaFechaContacto(c) }}</td>
                    <td>{{ c.user }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Selected company heading -->
        <div class="mb-2 selected-heading px-2">{{ selected.name || 'SELECCIONE UNA EMPRESA' }}</div>

        <!-- big rounded card with inner tabs -->
        <div class="card rounded-card p-3 position-relative">
        
        <!-- inner tabs -->
        <ul class="nav nav-tabs mb-3" role="tablist">
          <li class="nav-item" *ngFor="let t of tabs; let i = index">
            <a class="nav-link" [class.active]="activeTab === i" (click)="activeTab = i; $event.preventDefault()" href="javascript:void(0)">{{ t }}</a>
          </li>
        </ul>

        <div class="tab-content">
          <!-- Datos Empresa -->
          <div *ngIf="activeTab === 0" class="tab-pane active">
            <form [formGroup]="datosEmpresaForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">RAZON SOCIAL</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="razonSocial">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('razonSocial')?.invalid && datosEmpresaForm.get('razonSocial')?.touched">
                        Raz√≥n social es requerida
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">RUC.</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="ruc">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('ruc')?.invalid && datosEmpresaForm.get('ruc')?.touched">
                        Debe tener 11 d√≠gitos
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">SEDE PRINCIPAL</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="sedePrincipal">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">DOMICILIO</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="domicilio">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">NOMBRE CONTACT</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="nombreContacto">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('nombreContacto')?.invalid && datosEmpresaForm.get('nombreContacto')?.touched">
                        Nombre del contacto es requerido
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">CARGO</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="cargo">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">EMAIL</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="email">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('email')?.invalid && datosEmpresaForm.get('email')?.touched">
                        Email no v√°lido
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TELEFONO</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="telefono">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('telefono')?.invalid && datosEmpresaForm.get('telefono')?.touched">
                        Debe tener 9 d√≠gitos
                      </small>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">TIPO DE EMPRESA</label>
                    <div class="col-7">
                      <input class="form-control form-control-sm" formControlName="tipoEmpresa">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">NRO TRABAJAD</label>
                    <div class="col-7">
                      <input type="number" class="form-control form-control-sm" formControlName="nroTrabajadores">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('nroTrabajadores')?.invalid && datosEmpresaForm.get('nroTrabajadores')?.touched">
                        Debe ser mayor a 0
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">ACT. ECONOMICA</label>
                    <div class="col-7">
                      <input class="form-control form-control-sm" formControlName="actEconomica">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">RIESGO</label>
                    <div class="col-7">
                      <input class="form-control form-control-sm" formControlName="riesgo">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">SEDES</label>
                    <div class="col-7">
                      <textarea class="form-control form-control-sm" formControlName="sedes" rows="3"></textarea>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="position-absolute bottom-0 end-0 p-3">
                <button *ngIf="!isEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="editarEmpresa()">
                  Editar
                </button>
                <button *ngIf="isEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="guardarEmpresa()">
                  Guardar
                </button>
                <button *ngIf="isEditMode" type="button" class="btn btn-secondary btn-sm" (click)="cancelarEdicion()">
                  Cancelar
                </button>
              </div>
            </form>
          </div>

          <!-- Seguimiento -->
          <div *ngIf="activeTab === 1" class="tab-pane" style="display: block !important;">
            <form [formGroup]="seguimientoForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO CLIENTE</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoCliente"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO COMUNIC.</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoComunic"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">LINEA DE NEGOCIO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="lineaNegocio"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">SUB LINEA NEG.</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="subLinea"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO DE CREDITO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoCredito"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">PRESUPUESTO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="presupuesto"></div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">FECHA 1ER CTO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="fecha1erCto"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO CARTERA</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoCartera"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">ESTATUS CLIENTE</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="estatusCliente"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">DETALLE  ESTATUS</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="detalleEstatus"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO LLAMADA</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoLlamada"></div>
                  </div>
                </div>
              </div>

              <div class="mt-3">
                <label class="form-label small">OBSERVACIONES</label>
                <textarea class="form-control" rows="4" formControlName="observaciones"></textarea>
              </div>

              <!-- Action Buttons -->
              <div class="position-absolute bottom-0 end-0 p-3">
                <button *ngIf="!isSeguimientoEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="editarSeguimiento()">
                  Editar
                </button>
                <button *ngIf="isSeguimientoEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="guardarSeguimiento()">
                  Guardar
                </button>
                <button *ngIf="isSeguimientoEditMode" type="button" class="btn btn-secondary btn-sm" (click)="cancelarSeguimiento()">
                  Cancelar
                </button>
              </div>
            </form>
          </div>

          <!-- Historico -->
          <div *ngIf="activeTab === 2" class="tab-pane" style="display: block !important;">
            <div class="card">
              <div class="card-body p-2">
                <table class="table table-sm mb-0">
                  <thead class="table-light small">
                    <tr>
                      <th>FECHA</th>
                      <th>STATUS</th>
                      <th>contacto</th>
                      <th>USUARIO</th>
                      <th *ngIf="isHistoricoEditMode" style="width: 120px;">ACCIONES</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let h of selected?.history; let i = index">
                      <td class="text-primary">
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.fecha">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.fecha }}</span>
                      </td>
                      <td>
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.status">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.status }}</span>
                      </td>
                      <td>
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.contacto">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.contacto }}</span>
                      </td>
                      <td>
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.usuario">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.usuario }}</span>
                      </td>
                      <td *ngIf="isHistoricoEditMode">
                        <button *ngIf="editingHistoricoIndex !== i" class="btn btn-sm btn-outline-primary me-1" (click)="editarHistorico(i)" title="Editar">
                          <i class="bi bi-pencil"></i> ‚úèÔ∏è
                        </button>
                        <button *ngIf="editingHistoricoIndex === i" class="btn btn-sm btn-outline-success me-1" (click)="guardarHistorico(i)" title="Guardar">
                          üíæ
                        </button>
                        <button *ngIf="editingHistoricoIndex === i" class="btn btn-sm btn-outline-secondary me-1" (click)="cancelarHistorico()" title="Cancelar">
                          ‚ùå
                        </button>
                        <button class="btn btn-sm btn-outline-danger" (click)="eliminarHistorico(i)" title="Eliminar">
                          <i class="bi bi-trash"></i> üóëÔ∏è
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Action Button -->
            <div class="position-absolute bottom-0 end-0 p-3">
              <button *ngIf="!isHistoricoEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="isHistoricoEditMode = true">
                Editar
              </button>
              <button *ngIf="isHistoricoEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="agregarRegistroHistorico()">
                Agregar Registro
              </button>
              <button *ngIf="isHistoricoEditMode" type="button" class="btn btn-secondary btn-sm" (click)="isHistoricoEditMode = false">
                Cancelar
              </button>
            </div>
          </div>

          <!-- Protocolos y Cotizaciones -->
          <div *ngIf="activeTab === 3" class="tab-pane" style="display: block !important;">
            <div class="mb-4">
              <h6 class="section-title">PROTOCOLOS ENVIADOS POR EL CLIENTE</h6>
              <div class="card">
                <div class="card-body p-2">
                  <table class="table table-sm mb-0">
                    <thead class="table-light small">
                      <tr>
                        <th>FECHA</th>
                        <th>RUTA DOC</th>
                        <th>NOMBRE DOC</th>
                        <th>USUARIO</th>
                        <th *ngIf="isProtocolosEditMode" style="width: 120px;">ACCIONES</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let p of selected?.protocols; let i = index">
                        <td class="text-primary">
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.fecha">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.fecha }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.ruta">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.ruta }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.nombre">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.nombre }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.usuario">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.usuario }}</span>
                        </td>
                        <td *ngIf="isProtocolosEditMode">
                          <button *ngIf="editingProtocoloIndex !== i" class="btn btn-sm btn-outline-primary me-1" (click)="editarProtocolo(i)" title="Editar">
                            ‚úèÔ∏è
                          </button>
                          <button *ngIf="editingProtocoloIndex === i" class="btn btn-sm btn-outline-success me-1" (click)="guardarProtocolo(i)" title="Guardar">
                            üíæ
                          </button>
                          <button *ngIf="editingProtocoloIndex === i" class="btn btn-sm btn-outline-secondary me-1" (click)="cancelarProtocolo()" title="Cancelar">
                            ‚ùå
                          </button>
                          <button class="btn btn-sm btn-outline-danger" (click)="eliminarProtocolo(i)" title="Eliminar">
                            üóëÔ∏è
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div>
              <h6 class="section-title">COTIZACIONES ENVIADOS AL CLIENTE</h6>
              <div class="card">
                <div class="card-body p-2">
                  <table class="table table-sm mb-0">
                    <thead class="table-light small">
                      <tr>
                        <th>FECHA</th>
                        <th>RUTA DOC</th>
                        <th>NOMBRE DOC</th>
                        <th>USUARIO</th>
                        <th *ngIf="isProtocolosEditMode" style="width: 120px;">ACCIONES</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let q of selected?.quotes; let i = index">
                        <td class="text-primary">
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.fecha">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.fecha }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.ruta">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.ruta }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.nombre">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.nombre }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.usuario">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.usuario }}</span>
                        </td>
                        <td *ngIf="isProtocolosEditMode">
                          <button *ngIf="editingCotizacionIndex !== i" class="btn btn-sm btn-outline-primary me-1" (click)="editarCotizacion(i)" title="Editar">
                            ‚úèÔ∏è
                          </button>
                          <button *ngIf="editingCotizacionIndex === i" class="btn btn-sm btn-outline-success me-1" (click)="guardarCotizacion(i)" title="Guardar">
                            üíæ
                          </button>
                          <button *ngIf="editingCotizacionIndex === i" class="btn btn-sm btn-outline-secondary me-1" (click)="cancelarCotizacion()" title="Cancelar">
                            ‚ùå
                          </button>
                          <button class="btn btn-sm btn-outline-danger" (click)="eliminarCotizacion(i)" title="Eliminar">
                            üóëÔ∏è
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="position-absolute bottom-0 end-0 p-3">
              <button *ngIf="!isProtocolosEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="isProtocolosEditMode = true">
                Editar
              </button>
              <button *ngIf="isProtocolosEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="agregarProtocolo()">
                Agregar Protocolo
              </button>
              <button *ngIf="isProtocolosEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="agregarCotizacion()">
                Agregar Cotizaci√≥n
              </button>
              <button *ngIf="isProtocolosEditMode" type="button" class="btn btn-secondary btn-sm" (click)="isProtocolosEditMode = false">
                Cancelar
              </button>
            </div>
          </div>
        </div>
      </div>
      </div>

      <!-- AGENDA DEL D√çA view -->
      <div *ngIf="activeView === 1">
        <!-- companies grid for today -->
        <div class="card mb-3">
          <div class="card-body p-2">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span class="fw-bold small">AGENDA DEL D√çA - {{ fechaHoy }}</span>
              <button class="btn btn-primary btn-sm" (click)="agregarNuevaEmpresa()">
                <span>+ Nuevo Cliente</span>
              </button>
            </div>
            <div class="table-scroll-container">
              <table class="table table-sm mb-0">
                <thead class="table-light small">
                  <tr>
                    <th>Razon Social</th>
                    <th>Contacto</th>
                    <th>N√∫mero de contacto</th>
                    <th>Fecha de contacto</th>
                    <th>USUARIO</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let c of companiesAgendaHoy" (click)="selectCompany(c)" [class.table-primary]="selected.id === c.id" style="cursor:pointer">
                    <td><strong>{{ c.name }}</strong></td>
                    <td>{{ c.contact }}</td>
                    <td>{{ c.phone }}</td>
                    <td>{{ getUltimaFechaContacto(c) }}</td>
                    <td>{{ c.user }}</td>
                  </tr>
                  <tr *ngIf="companiesAgendaHoy.length === 0">
                    <td colspan="5" class="text-center text-muted py-3">
                      No hay contactos programados para hoy
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Selected company heading -->
        <div class="mb-2 selected-heading px-2">{{ selected.name || 'SELECCIONE UNA EMPRESA' }}</div>

        <!-- big rounded card with inner tabs -->
        <div class="card rounded-card p-3 position-relative">
        
        <!-- inner tabs -->
        <ul class="nav nav-tabs mb-3" role="tablist">
          <li class="nav-item" *ngFor="let t of tabs; let i = index">
            <a class="nav-link" [class.active]="activeTab === i" (click)="activeTab = i; $event.preventDefault()" href="javascript:void(0)">{{ t }}</a>
          </li>
        </ul>

        <div class="tab-content">
          <!-- Datos Empresa -->
          <div *ngIf="activeTab === 0" class="tab-pane active">
            <form [formGroup]="datosEmpresaForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">RAZON SOCIAL</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="razonSocial">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('razonSocial')?.invalid && datosEmpresaForm.get('razonSocial')?.touched">
                        Raz√≥n social es requerida
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">RUC.</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="ruc">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('ruc')?.invalid && datosEmpresaForm.get('ruc')?.touched">
                        Debe tener 11 d√≠gitos
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">SEDE PRINCIPAL</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="sedePrincipal">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">DOMICILIO</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="domicilio">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">NOMBRE CONTACT</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="nombreContacto">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('nombreContacto')?.invalid && datosEmpresaForm.get('nombreContacto')?.touched">
                        Nombre del contacto es requerido
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">CARGO</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="cargo">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">EMAIL</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="email">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('email')?.invalid && datosEmpresaForm.get('email')?.touched">
                        Email no v√°lido
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TELEFONO</label>
                    <div class="col-8">
                      <input class="form-control form-control-sm" formControlName="telefono">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('telefono')?.invalid && datosEmpresaForm.get('telefono')?.touched">
                        Debe tener 9 d√≠gitos
                      </small>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">TIPO DE EMPRESA</label>
                    <div class="col-7">
                      <input class="form-control form-control-sm" formControlName="tipoEmpresa">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">NRO TRABAJAD</label>
                    <div class="col-7">
                      <input type="number" class="form-control form-control-sm" formControlName="nroTrabajadores">
                      <small class="text-danger" *ngIf="datosEmpresaForm.get('nroTrabajadores')?.invalid && datosEmpresaForm.get('nroTrabajadores')?.touched">
                        Debe ser mayor a 0
                      </small>
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">ACT. ECONOMICA</label>
                    <div class="col-7">
                      <input class="form-control form-control-sm" formControlName="actEconomica">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">RIESGO</label>
                    <div class="col-7">
                      <input class="form-control form-control-sm" formControlName="riesgo">
                    </div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-5 col-form-label small">SEDES</label>
                    <div class="col-7">
                      <textarea class="form-control form-control-sm" formControlName="sedes" rows="3"></textarea>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="position-absolute bottom-0 end-0 p-3">
                <button *ngIf="!isEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="editarEmpresa()">
                  Editar
                </button>
                <button *ngIf="isEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="guardarEmpresa()">
                  Guardar
                </button>
                <button *ngIf="isEditMode" type="button" class="btn btn-secondary btn-sm" (click)="cancelarEdicion()">
                  Cancelar
                </button>
              </div>
            </form>
          </div>

          <!-- Seguimiento -->
          <div *ngIf="activeTab === 1" class="tab-pane" style="display: block !important;">
            <form [formGroup]="seguimientoForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO CLIENTE</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoCliente"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO COMUNIC.</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoComunic"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">LINEA DE NEGOCIO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="lineaNegocio"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">SUB LINEA NEG.</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="subLinea"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO DE CREDITO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoCredito"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">PRESUPUESTO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="presupuesto"></div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">FECHA 1ER CTO</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="fecha1erCto"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO CARTERA</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoCartera"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">ESTATUS CLIENTE</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="estatusCliente"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">DETALLE ESTATUS</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="detalleEstatus"></div>
                  </div>
                  <div class="mb-2 row">
                    <label class="col-4 col-form-label small">TIPO LLAMADA</label>
                    <div class="col-8"><input class="form-control form-control-sm" formControlName="tipoLlamada"></div>
                  </div>
                </div>
              </div>

              <div class="mt-3">
                <label class="form-label small">OBSERVACIONES</label>
                <textarea class="form-control" rows="4" formControlName="observaciones"></textarea>
              </div>

              <!-- Action Buttons -->
              <div class="position-absolute bottom-0 end-0 p-3">
                <button *ngIf="!isSeguimientoEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="editarSeguimiento()">
                  Editar
                </button>
                <button *ngIf="isSeguimientoEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="guardarSeguimiento()">
                  Guardar
                </button>
                <button *ngIf="isSeguimientoEditMode" type="button" class="btn btn-secondary btn-sm" (click)="cancelarSeguimiento()">
                  Cancelar
                </button>
              </div>
            </form>
          </div>

          <!-- Historico -->
          <div *ngIf="activeTab === 2" class="tab-pane" style="display: block !important;">
            <div class="card">
              <div class="card-body p-2">
                <table class="table table-sm mb-0">
                  <thead class="table-light small">
                    <tr>
                      <th>FECHA</th>
                      <th>STATUS</th>
                      <th>contacto</th>
                      <th>USUARIO</th>
                      <th *ngIf="isHistoricoEditMode" style="width: 120px;">ACCIONES</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let h of selected?.history; let i = index">
                      <td class="text-primary">
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.fecha">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.fecha }}</span>
                      </td>
                      <td>
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.status">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.status }}</span>
                      </td>
                      <td>
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.contacto">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.contacto }}</span>
                      </td>
                      <td>
                        <input *ngIf="editingHistoricoIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="h.usuario">
                        <span *ngIf="editingHistoricoIndex !== i">{{ h.usuario }}</span>
                      </td>
                      <td *ngIf="isHistoricoEditMode">
                        <button *ngIf="editingHistoricoIndex !== i" class="btn btn-sm btn-outline-primary me-1" (click)="editarHistorico(i)" title="Editar">
                          <i class="bi bi-pencil"></i> ‚úèÔ∏è
                        </button>
                        <button *ngIf="editingHistoricoIndex === i" class="btn btn-sm btn-outline-success me-1" (click)="guardarHistorico(i)" title="Guardar">
                          üíæ
                        </button>
                        <button *ngIf="editingHistoricoIndex === i" class="btn btn-sm btn-outline-secondary me-1" (click)="cancelarHistorico()" title="Cancelar">
                          ‚ùå
                        </button>
                        <button class="btn btn-sm btn-outline-danger" (click)="eliminarHistorico(i)" title="Eliminar">
                          <i class="bi bi-trash"></i> üóëÔ∏è
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Action Button -->
            <div class="position-absolute bottom-0 end-0 p-3">
              <button *ngIf="!isHistoricoEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="isHistoricoEditMode = true">
                Editar
              </button>
              <button *ngIf="isHistoricoEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="agregarRegistroHistorico()">
                Agregar Registro
              </button>
              <button *ngIf="isHistoricoEditMode" type="button" class="btn btn-secondary btn-sm" (click)="isHistoricoEditMode = false">
                Cancelar
              </button>
            </div>
          </div>

          <!-- Protocolos y Cotizaciones -->
          <div *ngIf="activeTab === 3" class="tab-pane" style="display: block !important;">
            <div class="mb-4">
              <h6 class="section-title">PROTOCOLOS ENVIADOS POR EL CLIENTE</h6>
              <div class="card">
                <div class="card-body p-2">
                  <table class="table table-sm mb-0">
                    <thead class="table-light small">
                      <tr>
                        <th>FECHA</th>
                        <th>RUTA DOC</th>
                        <th>NOMBRE DOC</th>
                        <th>USUARIO</th>
                        <th *ngIf="isProtocolosEditMode" style="width: 120px;">ACCIONES</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let p of selected?.protocols; let i = index">
                        <td class="text-primary">
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.fecha">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.fecha }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.ruta">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.ruta }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.nombre">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.nombre }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingProtocoloIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="p.usuario">
                          <span *ngIf="editingProtocoloIndex !== i">{{ p.usuario }}</span>
                        </td>
                        <td *ngIf="isProtocolosEditMode">
                          <button *ngIf="editingProtocoloIndex !== i" class="btn btn-sm btn-outline-primary me-1" (click)="editarProtocolo(i)" title="Editar">
                            ‚úèÔ∏è
                          </button>
                          <button *ngIf="editingProtocoloIndex === i" class="btn btn-sm btn-outline-success me-1" (click)="guardarProtocolo(i)" title="Guardar">
                            üíæ
                          </button>
                          <button *ngIf="editingProtocoloIndex === i" class="btn btn-sm btn-outline-secondary me-1" (click)="cancelarProtocolo()" title="Cancelar">
                            ‚ùå
                          </button>
                          <button class="btn btn-sm btn-outline-danger" (click)="eliminarProtocolo(i)" title="Eliminar">
                            üóëÔ∏è
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div>
              <h6 class="section-title">COTIZACIONES ENVIADOS AL CLIENTE</h6>
              <div class="card">
                <div class="card-body p-2">
                  <table class="table table-sm mb-0">
                    <thead class="table-light small">
                      <tr>
                        <th>FECHA</th>
                        <th>RUTA DOC</th>
                        <th>NOMBRE DOC</th>
                        <th>USUARIO</th>
                        <th *ngIf="isProtocolosEditMode" style="width: 120px;">ACCIONES</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let q of selected?.quotes; let i = index">
                        <td class="text-primary">
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.fecha">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.fecha }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.ruta">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.ruta }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.nombre">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.nombre }}</span>
                        </td>
                        <td>
                          <input *ngIf="editingCotizacionIndex === i" type="text" class="form-control form-control-sm" [(ngModel)]="q.usuario">
                          <span *ngIf="editingCotizacionIndex !== i">{{ q.usuario }}</span>
                        </td>
                        <td *ngIf="isProtocolosEditMode">
                          <button *ngIf="editingCotizacionIndex !== i" class="btn btn-sm btn-outline-primary me-1" (click)="editarCotizacion(i)" title="Editar">
                            ‚úèÔ∏è
                          </button>
                          <button *ngIf="editingCotizacionIndex === i" class="btn btn-sm btn-outline-success me-1" (click)="guardarCotizacion(i)" title="Guardar">
                            üíæ
                          </button>
                          <button *ngIf="editingCotizacionIndex === i" class="btn btn-sm btn-outline-secondary me-1" (click)="cancelarCotizacion()" title="Cancelar">
                            ‚ùå
                          </button>
                          <button class="btn btn-sm btn-outline-danger" (click)="eliminarCotizacion(i)" title="Eliminar">
                            üóëÔ∏è
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="position-absolute bottom-0 end-0 p-3">
              <button *ngIf="!isProtocolosEditMode" type="button" class="btn btn-primary btn-sm me-2" (click)="isProtocolosEditMode = true">
                Editar
              </button>
              <button *ngIf="isProtocolosEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="agregarProtocolo()">
                Agregar Protocolo
              </button>
              <button *ngIf="isProtocolosEditMode" type="button" class="btn btn-success btn-sm me-2" (click)="agregarCotizacion()">
                Agregar Cotizaci√≥n
              </button>
              <button *ngIf="isProtocolosEditMode" type="button" class="btn btn-secondary btn-sm" (click)="isProtocolosEditMode = false">
                Cancelar
              </button>
            </div>
          </div>
        </div>
      </div>
      </div>

      <!-- PENDIENTES ACUMULADOS view -->
      <div *ngIf="activeView === 2">
        <div class="card p-3 mb-3">
          <div class="row align-items-center">
            <div class="col-md-4">
              <label class="form-label small mb-1 fw-bold">Prioridad</label>
              <select class="form-select" [(ngModel)]="prioridadFilterAcumulados">
                <option value="Todos">‚Äî Todos ‚Äî</option>
                <option value="Alta">Alta</option>
                <option value="Media">Media</option>
                <option value="Baja">Baja</option>
              </select>
            </div>
            <div class="col-md-5">
              <label class="form-label small mb-1 fw-bold">Fecha</label>
              <div class="d-flex gap-2 align-items-center">
                <input type="date" class="form-control" [(ngModel)]="fechaInicioAcumulados" placeholder="Desde">
                <span>‚Äì</span>
                <input type="date" class="form-control" [(ngModel)]="fechaFinAcumulados" placeholder="Hasta">
              </div>
            </div>
            <div class="col-md-3 d-flex align-items-end">
              <button class="btn btn-primary w-100" (click)="limpiarFiltrosAcumulados()">Limpiar filtros</button>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <table class="table table-sm mb-0">
              <thead class="table-light small">
                <tr>
                  <th>Fecha</th>
                  <th>Cliente</th>
                  <th>Contacto</th>
                  <th>Prioridad</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of filteredPendientesAcumulados" style="cursor:pointer">
                  <td>{{ p.fecha }}</td>
                  <td class="text-primary fw-bold">{{ p.cliente }}</td>
                  <td>{{ p.contacto }}</td>
                  <td>
                    <span class="badge" [ngClass]="{
                      'bg-danger': p.prioridad === 'Alta',
                      'bg-warning': p.prioridad === 'Media',
                      'bg-success': p.prioridad === 'Baja'
                    }">{{ p.prioridad }}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- ASIG. SUPERVISOR view -->
      <div *ngIf="activeView === 4">
        <div class="row">
          <!-- Left sidebar -->
          <div class="col-md-3">
            <div class="card p-3 mb-3">
              <h6 class="fw-bold mb-3">Agenda del equipo</h6>
              
              <div class="mb-3">
                <h6 class="fw-bold small mb-2">Leyenda de colores</h6>
                <div class="d-flex align-items-center mb-2">
                  <div class="legend-color" style="background: #6c9eff;"></div>
                  <span class="small">Reuniones</span>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <div class="legend-color" style="background: #6dd5a4;"></div>
                  <span class="small">Visitas</span>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <div class="legend-color" style="background: #ffb347;"></div>
                  <span class="small">Seguimientos/llamadas</span>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <div class="legend-color" style="background: #ff6b6b;"></div>
                  <span class="small">Presentaciones</span>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <div class="legend-color" style="background: #b8a3ff;"></div>
                  <span class="small">Alto valor</span>
                </div>
              </div>

              <hr>

              <div class="mb-3">
                <h6 class="fw-bold small mb-2">Resumen de hoy</h6>
                <div class="small mb-1"><strong>3</strong> reuniones</div>
                <div class="small mb-1"><strong>2</strong> visitas</div>
                <div class="small"><strong>1</strong> seguimiento de alto valor</div>
              </div>

              <hr>

              <div class="mb-3">
                <h6 class="fw-bold small mb-2">Resumen de hoy</h6>
                <div class="small mb-1">3 reuniones - 2 Visitas</div>
                <div class="small">1 seguimiento d'alto valor</div>
              </div>

              <button class="btn btn-primary w-100">+ Nueva actividad</button>
            </div>
          </div>

          <!-- Calendar view -->
          <div class="col-md-9">
            <div class="card p-3">
              <!-- Filters -->
              <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="d-flex gap-3 align-items-center">
                  <div>
                    <label class="small fw-bold mb-1">Ejecutivo</label>
                    <select class="form-select form-select-sm" style="width: 200px;">
                      <option>‚Äî Todos ‚Äî</option>
                    </select>
                  </div>
                  <div>
                    <label class="small fw-bold mb-1">Vista</label>
                    <div class="input-group input-group-sm" style="width: 280px;">
                      <input type="text" class="form-control" value="22/04/2024 ‚Äì 28/04/2024" readonly>
                      <button class="btn btn-outline-secondary" type="button">üìÖ</button>
                    </div>
                  </div>
                </div>
                <button class="btn btn-primary btn-sm">Limpiar filtros</button>
              </div>

              <!-- Calendar grid -->
              <div class="calendar-grid">
                <!-- Header -->
                <div class="calendar-header">
                  <div class="time-column"></div>
                  <div class="day-column">
                    <div class="day-label">Lun 22</div>
                  </div>
                  <div class="day-column">
                    <div class="day-label">Mar 23</div>
                  </div>
                  <div class="day-column">
                    <div class="day-label">Mi√© 24</div>
                  </div>
                  <div class="day-column">
                    <div class="day-label">Jue 25</div>
                  </div>
                  <div class="day-column">
                    <div class="day-label">Vie 26</div>
                  </div>
                  <div class="day-column">
                    <div class="day-label">S√° 27</div>
                  </div>
                  <div class="day-column">
                    <div class="day-label">Dom 28</div>
                  </div>
                </div>

                <!-- Time slots -->
                <div class="calendar-body">
                  <!-- 09:00 row -->
                  <div class="time-row">
                    <div class="time-label">09:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>

                  <!-- 11:00 row -->
                  <div class="time-row">
                    <div class="time-label">11:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell">
                      <div class="event event-reunion">
                        <div class="event-title">EMPRESA ALFA</div>
                        <div class="event-subtitle">Reuni√≥n - Lopez</div>
                      </div>
                    </div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>

                  <!-- 13:00 row -->
                  <div class="time-row">
                    <div class="time-label">13:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell">
                      <div class="event event-visita">
                        <div class="event-title">EMPRESA BETA</div>
                        <div class="event-subtitle">Visita - Parez</div>
                      </div>
                    </div>
                    <div class="time-cell">
                      <div class="event event-presentacion">
                        <div class="event-title">EMPRESA GAMMA</div>
                        <div class="event-subtitle">Presentaci√≥n</div>
                      </div>
                    </div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>

                  <!-- 15:00 row -->
                  <div class="time-row">
                    <div class="time-label">15:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>

                  <!-- 17:00 row -->
                  <div class="time-row">
                    <div class="time-label">17:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell">
                      <div class="event event-seguimiento">
                        <div class="event-title">Seguimientos</div>
                        <div class="event-subtitle">/llamadas</div>
                      </div>
                    </div>
                    <div class="time-cell"></div>
                    <div class="time-cell">
                      <div class="event event-alto-valor">
                        <div class="event-title">Alto valor</div>
                        <div class="event-subtitle">Cierre semana</div>
                      </div>
                    </div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>

                  <!-- 18:00 row -->
                  <div class="time-row">
                    <div class="time-label">18:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>

                  <!-- 19:00 row -->
                  <div class="time-row">
                    <div class="time-label">19:00</div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                    <div class="time-cell"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- PENDIENTES OLVIDADOS view -->
      <div *ngIf="activeView === 3">
        <div class="card p-3 mb-3">
          <div class="row align-items-center">
            <div class="col-md-4">
              <label class="form-label small mb-1 fw-bold">Prioridad</label>
              <select class="form-select" [(ngModel)]="prioridadFilterOlvidados">
                <option value="Todos">‚Äî Todos ‚Äî</option>
                <option value="Alta">Alta</option>
                <option value="Media">Media</option>
                <option value="Baja">Baja</option>
              </select>
            </div>
            <div class="col-md-5">
              <label class="form-label small mb-1 fw-bold">Fecha</label>
              <div class="d-flex gap-2 align-items-center">
                <input type="date" class="form-control" [(ngModel)]="fechaInicioOlvidados" placeholder="Desde">
                <span>‚Äì</span>
                <input type="date" class="form-control" [(ngModel)]="fechaFinOlvidados" placeholder="Hasta">
              </div>
            </div>
            <div class="col-md-3 d-flex align-items-end">
              <button class="btn btn-primary w-100" (click)="limpiarFiltrosOlvidados()">Limpiar filtros</button>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <table class="table table-sm mb-0">
              <thead class="table-light small">
                <tr>
                  <th>Fecha</th>
                  <th>Cliente</th>
                  <th>Contacto</th>
                  <th>Prioridad</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of filteredPendientesOlvidados" style="cursor:pointer">
                  <td>{{ p.fecha }}</td>
                  <td class="text-primary fw-bold">{{ p.cliente }}</td>
                  <td>{{ p.contacto }}</td>
                  <td>
                    <span class="badge" [ngClass]="{
                      'bg-danger': p.prioridad === 'Alta',
                      'bg-warning': p.prioridad === 'Media',
                      'bg-success': p.prioridad === 'Baja'
                    }">{{ p.prioridad }}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- CERRADOS view -->
      <div *ngIf="activeView === 5">
        <!-- Metrics cards -->
        <div class="row mb-3">
          <div class="col-md-4">
            <div class="metric-card metric-card-green">
              <div class="metric-label">Monto Acumulado Semanal</div>
              <div class="metric-value">S/ 10,650.00</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="metric-card metric-card-blue">
              <div class="metric-label">Contratos Cerrados</div>
              <div class="metric-value">4</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="metric-card metric-card-primary">
              <div class="metric-label">Meta Semanal</div>
              <div class="metric-value">85%</div>
              <div class="progress mt-2" style="height: 8px;">
                <div class="progress-bar bg-success" role="progressbar" style="width: 85%"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Performance chart and history -->
        <div class="row">
          <div class="col-md-6">
            <div class="card">
              <div class="card-body">
                <h6 class="fw-bold mb-3">Rendimiento Diario</h6>
                <div class="chart-container">
                  <canvas id="dailyPerformanceChart" style="max-height: 250px;"></canvas>
                </div>
                <!-- Simple bar chart visualization -->
                <div class="simple-chart">
                  <div class="chart-bars">
                    <div class="chart-bar-group">
                      <div class="chart-bar" style="height: 40%;" data-label="Lunes"></div>
                      <span class="chart-label">Lunes</span>
                    </div>
                    <div class="chart-bar-group">
                      <div class="chart-bar" style="height: 45%;" data-label="Martes"></div>
                      <span class="chart-label">Martes</span>
                    </div>
                    <div class="chart-bar-group">
                      <div class="chart-bar" style="height: 75%;" data-label="Mi√©rcoles"></div>
                      <span class="chart-label">Mi√©rcoles</span>
                    </div>
                    <div class="chart-bar-group">
                      <div class="chart-bar" style="height: 85%;" data-label="Jueves"></div>
                      <span class="chart-label">Jueves</span>
                    </div>
                    <div class="chart-bar-group">
                      <div class="chart-bar" style="height: 95%;" data-label="Viernes"></div>
                      <span class="chart-label">Viernes</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card">
              <div class="card-body">
                <h6 class="fw-bold mb-3">Historial Reciente</h6>
                <table class="table table-sm mb-0">
                  <thead class="table-light small">
                    <tr>
                      <th>Empresa</th>
                      <th>Servicio</th>
                      <th>Fecha</th>
                      <th>Monto</th>
                      <th>Estado</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Inversiones del Sur S.A.C.</td>
                      <td>An√°lisis de Suelos</td>
                      <td>18/11/2025</td>
                      <td>S/ 2,500.00</td>
                      <td><span class="badge bg-success">Cerrado</span></td>
                    </tr>
                    <tr>
                      <td>Constructora Lima Norte E.I.R.L.</td>
                      <td>Ensayo de Concreto</td>
                      <td>19/11/2025</td>
                      <td>S/ 3,200.00</td>
                      <td><span class="badge bg-success">Cerrado</span></td>
                    </tr>
                    <tr>
                      <td>Minera Pac√≠fico S.A.</td>
                      <td>An√°lisis de Aguas</td>
                      <td>20/11/2025</td>
                      <td>S/ 4,950.00</td>
                      <td><span class="badge bg-success">Cerrado</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- PROD. D√çA view -->
      <div *ngIf="activeView === 6">
        <div class="card">
          <div class="card-body p-3">
            <h5 class="fw-bold mb-4">Productividad del D√≠a</h5>
            
            <!-- Performance table with bars -->
            <div class="prod-table">
              <div class="prod-header">
                <div class="prod-col-user">usuario</div>
                <div class="prod-col-name">Nombre</div>
                <div class="prod-col-chart">Agendados Ejecutivo</div>
                <div class="prod-col-chart">Asignados supervisor</div>
                <div class="prod-col-action">Asignar</div>
              </div>

              <!-- Row 1: jperez -->
              <div class="prod-row">
                <div class="prod-col-user">jperez</div>
                <div class="prod-col-name">Juan Perez</div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar" style="width: 20%;">
                      <span class="bar-label">20</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar horizontal-bar-orange" style="width: 62%;">
                      <span class="bar-label">62</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-action">
                  <button class="btn btn-success btn-sm">Asignar</button>
                </div>
              </div>

              <!-- Row 2: aserrano -->
              <div class="prod-row">
                <div class="prod-col-user">aserrano</div>
                <div class="prod-col-name">Alondra Serrano</div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar" style="width: 10%;">
                      <span class="bar-label">10</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar horizontal-bar-orange" style="width: 70%;">
                      <span class="bar-label">70</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-action">
                  <button class="btn btn-success btn-sm">Asignar</button>
                </div>
              </div>

              <!-- Row 3: avaldiviezo -->
              <div class="prod-row">
                <div class="prod-col-user">avaldiviezo</div>
                <div class="prod-col-name">Alberto Valdiviezo</div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar" style="width: 50%;">
                      <span class="bar-label">50</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar horizontal-bar-orange" style="width: 25%;">
                      <span class="bar-label">25</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-action">
                  <button class="btn btn-success btn-sm">Asignar</button>
                </div>
              </div>

              <!-- Row 4: jsanchez -->
              <div class="prod-row">
                <div class="prod-col-user">jsanchez</div>
                <div class="prod-col-name">Julio Sanchez</div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar" style="width: 40%;">
                      <span class="bar-label">40</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-chart">
                  <div class="horizontal-bar-wrapper">
                    <div class="horizontal-bar horizontal-bar-orange" style="width: 48%;">
                      <span class="bar-label">48</span>
                    </div>
                  </div>
                </div>
                <div class="prod-col-action">
                  <button class="btn btn-success btn-sm">Asignar</button>
                </div>
              </div>
            </div>

            <!-- Chart visualization below table -->
            <div class="mt-4">
              <div class="prod-chart-section">
                <div class="row">
                  <div class="col-md-6" *ngFor="let user of prodDiaUsers">
                    <div class="prod-chart-item mb-3">
                      <div class="prod-chart-label">{{ user.nombre }}</div>
                      <div class="prod-chart-bars">
                        <div class="prod-chart-bar-group">
                          <div class="prod-chart-bar prod-chart-bar-blue" [style.width.%]="user.agendados"></div>
                          <span class="prod-chart-value">{{ user.agendados }}</span>
                        </div>
                        <div class="prod-chart-bar-group">
                          <div class="prod-chart-bar prod-chart-bar-orange" [style.width.%]="user.asignados"></div>
                          <span class="prod-chart-value">{{ user.asignados }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Legend -->
              <div class="d-flex justify-content-center gap-4 mt-3">
                <div class="d-flex align-items-center">
                  <div class="legend-box" style="background: #2e7db5;"></div>
                  <span class="small">Agendados Ejecutivo</span>
                </div>
                <div class="d-flex align-items-center">
                  <div class="legend-box" style="background: #ff8c42;"></div>
                  <span class="small">Asignados supervisor</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </main>
  </div>
</div>
<!-- ...existing code... -->